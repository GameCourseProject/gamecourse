<div class="w-full relative">
  <!-- Header -->
  <app-header [title] = "'Adaptation'" [icon] = "'tabler-puzzle'"
              [loading] = "loading.action" ></app-header>

  <ng-container *ngIf="!loading.page">
    <!-- Admin Template -->
    <ng-container *ngIf="true" [ngTemplateOutlet]="ADMIN"></ng-container>

    <!-- Non-Admin Template -->
    <ng-container *ngIf="false" [ngTemplateOutlet]="NON_ADMIN"></ng-container>
  </ng-container>

</div>

<!-- Admin Template -->
<ng-template #ADMIN>
  <div class="w-full relative">
    <app-table
      [id] = "'gameElements'"
      [classList]="'mt-5'"
      [headers] = "headers"
      [data] = "data"
      [options] = "tableOptions"
      [loading] = "loading.table"
      (btnClicked)="doActionOnTable($event.type, $event.row, $event.col)"
      (valueChanged)="doActionOnTable('value changed game element', $event.row, $event.col, $event.value)">
    </app-table>

    <!-- Loader -->
    <app-loader [loading] = "loading.page"></app-loader>
  </div>
</ng-template>

<ng-template #NON_ADMIN>

  <div class="sm:w-1/2">
    <app-input-select
      [id]="'game-elements'"
      [(value)] = "selectedGameElement"
      [options] = "availableGameElements"
      [multiple] = "false"
      [search] = "true"
      [placeholder]="'Select game element'"
      [topLabel]="'Choose a game element to adapt'"
      (valueChange)="selectedGameElement = $event ?? []"
    ></app-input-select>
  </div>

  <div *ngIf = "selectedGameElement" class="w-full flex flex-wrap mt-7">

    <div class="sm:w-5/12">
      <strong>CURRENT - [OPTION {{getPreviousPreference()}}]</strong>
    </div>

    <div class="divider divider-horizontal rounded bg-base-200"></div>

    <div class="sm:w-5/12">
      <strong>NEW</strong>

      <p class="mt-2">Options available</p>
      <div class="btn-group flex justify-start sm:mr-[6rem] mt-2">
        <div *ngFor="let option of getChildren(selectedGameElement); let i = index" class="pr-1">
          <input type = "button"
                 class="btn-sm rounded-lg btn-{{getButtonColor(i)}} px-2 text-white"
                 value="Option {{i+1}}"
                 (click) = "setButtonActive(i); doAction(option)"/>
        </div>
      </div>
    </div>

  </div>

  <!-- Actions -->
  <div class="flex items-center justify-end mt-6 sm:mr-[6rem]">
    <button type="button" class="btn btn-ghost mr-2" (click)="discard()">Discard changes</button>
    <button type="submit" class="btn btn-primary" (click)="save()">
      <!-- Spinner -->
      <ng-container *ngIf="loading.action">
        <app-spinner [size]="'sm'" [color]="'primary-content'" [classList]="'mr-3'"></app-spinner>
      </ng-container>
      Save preferences
    </button>
  </div>
</ng-template>




