<ng-container
  [ngTemplateOutlet]="SIMPLE">
</ng-container>


<!------------------------------------------------>
<!------------------ VARIATIONS ------------------>
<!------------------------------------------------>

<ng-template #SIMPLE>
  <div [attr.id]="view.cssId"
       [classList]="view.class"
       [attr.style]="view.style"
       [attr.data-id]="view.id"
       [attr.data-viewId]="view.viewId"
       [attr.data-label]="view.label"
       [attr.data-role]="edit ? view.role : null"
       [goToPage]="getEvent(view, EventAction.GO_TO_PAGE) | as : EventGoToPage"
       [hideView]="getEvent(view, EventAction.HIDE_VIEW) | as : EventHideView"
       [showView]="getEvent(view, EventAction.SHOW_VIEW) | as : EventShowView"
       [toggleView]="getEvent(view, EventAction.TOGGLE_VIEW) | as : EventToggleView"
       [mode]="view.mode">
    <table>

      <!-- Header -->
      <thead>
        <tr *ngIf="edit && view.isEditingLayout && view.nrColumns > 0" style="height: 30px;">
          <th *ngFor="let repeat of [].constructor(view.nrColumns); let i = index" [classList]="ViewTable.TABLE_TOOLBAR_CLASS">
            <ng-container [ngTemplateOutlet]="TOP_TOOLBAR" [ngTemplateOutletContext]="{column: i}"></ng-container>
          </th>
        </tr>

        <tr *ngIf="edit && view.isEditingLayout && !view.headerRows.length" class="add-header-rows">
          <th><button (click)="actionManager.triggerAction({action: EditorAction.TABLE_ADD_HEADER_ROW})">Add Header Row</button></th>
        </tr>

        <tr *ngFor="let row of view.headerRows; let i = index"
            [attr.id]="row.cssId"
            [classList]="row.class" [ngClass]="row.children.length === 0 ? ViewRow.ROW_EMPTY_CLASS : ''"
            [attr.style]="row.style"
            [attr.data-id]="row.id"
            [attr.data-viewId]="row.viewId"
            [attr.data-label]="row.label"
            [attr.data-role]="edit ? row.role : null"
            [goToPage]="getEvent(row, EventAction.GO_TO_PAGE) | as : EventGoToPage"
            [hideView]="getEvent(row, EventAction.HIDE_VIEW) | as : EventHideView"
            [showView]="getEvent(row, EventAction.SHOW_VIEW) | as : EventShowView"
            [toggleView]="getEvent(row, EventAction.TOGGLE_VIEW) | as : EventToggleView"
            [mode]="view.mode">

          <th *ngFor="let header of row.children" [classList]="ViewRow.ROW_CHILD_CLASS">
            <bb-any [view]="header"></bb-any>
          </th>

          <th *ngIf="edit && view.isEditingLayout" [classList]="ViewTable.TABLE_TOOLBAR_CLASS" style="width: 160px">
            <ng-container [ngTemplateOutlet]="RIGHT_TOOLBAR" [ngTemplateOutletContext]="{row: i, type: 'header'}"></ng-container>
          </th>
        </tr>
      </thead>

      <!-- Body -->
      <tbody>
        <tr *ngIf="edit && view.isEditingLayout && !view.rows.length" class="add-body-rows">
          <td><button (click)="actionManager.triggerAction({action: EditorAction.TABLE_ADD_ROW})">Add Row</button></td>
        </tr>

        <tr *ngFor="let row of view.rows; let i = index"
            [attr.id]="row.cssId"
            [classList]="row.class" [ngClass]="row.children.length === 0 ? ViewRow.ROW_EMPTY_CLASS : ''"
            [attr.style]="row.style"
            [attr.data-id]="row.id"
            [attr.data-viewId]="row.viewId"
            [attr.data-label]="row.label"
            [attr.data-role]="edit ? row.role : null"
            [goToPage]="getEvent(row, EventAction.GO_TO_PAGE) | as : EventGoToPage"
            [hideView]="getEvent(row, EventAction.HIDE_VIEW) | as : EventHideView"
            [showView]="getEvent(row, EventAction.SHOW_VIEW) | as : EventShowView"
            [toggleView]="getEvent(row, EventAction.TOGGLE_VIEW) | as : EventToggleView"
            [mode]="view.mode">

          <td *ngFor="let item of row.children" [classList]="ViewRow.ROW_CHILD_CLASS">
            <bb-any [view]="item"></bb-any>
          </td>

          <td *ngIf="edit && view.isEditingLayout" [classList]="ViewTable.TABLE_TOOLBAR_CLASS" style="width: 160px">
            <ng-container [ngTemplateOutlet]="RIGHT_TOOLBAR" [ngTemplateOutletContext]="{row: i, type: 'body'}"></ng-container>
          </td>
        </tr>
      </tbody>

    </table>
  </div>
</ng-template>


<ng-template #TOP_TOOLBAR let-col='column'>
  <div>
    <div *ngIf="view.nrColumns > 1" class="tool-btn" title="Move Left" (click)="actionManager.triggerAction({action: EditorAction.TABLE_MOVE_LEFT, params: col})"><img src="assets/icons/arrow_left_icon.svg" alt="Move Left"></div>
    <div *ngIf="view.nrColumns > 1" class="tool-btn" title="Move Right" (click)="actionManager.triggerAction({action: EditorAction.TABLE_MOVE_RIGHT, params: col})"><img src="assets/icons/arrow_right_icon.svg" alt="Move Right"></div>
    <div class="tool-btn" title="Insert Left" (click)="actionManager.triggerAction({action: EditorAction.TABLE_INSERT_LEFT, params: col})"><img src="assets/icons/add_left_icon.svg" alt="Insert Left"></div>
    <div class="tool-btn" title="Insert Right" (click)="actionManager.triggerAction({action: EditorAction.TABLE_INSERT_RIGHT, params: col})"><img src="assets/icons/add_right_icon.svg" alt="Insert Right"></div>
    <div class="tool-btn" title="Delete Column" (click)="actionManager.triggerAction({action: EditorAction.TABLE_DELETE_COLUMN, params: col})"><img src="assets/icons/delete_icon.svg" alt="Delete Column"></div>
  </div>
</ng-template>

<ng-template #RIGHT_TOOLBAR let-row='row' let-type='type'>
  <div>
    <div *ngIf="(type === 'header' && view.headerRows.length > 1) || view.rows.length > 1" class="tool-btn" title="Move Up" (click)="actionManager.triggerAction({action: EditorAction.TABLE_MOVE_UP, params: {row, type}})"><img src="assets/icons/arrow_top_icon.svg" alt="Move Up"></div>
    <div *ngIf="(type === 'header' && view.headerRows.length > 1) || view.rows.length > 1" class="tool-btn" title="Move Down" (click)="actionManager.triggerAction({action: EditorAction.TABLE_MOVE_DOWN, params: {row, type}})"><img src="assets/icons/arrow_bottom_icon.svg" alt="Move Down"></div>
    <div class="tool-btn" title="Insert Up" (click)="actionManager.triggerAction({action: EditorAction.TABLE_INSERT_UP, params: {row, type}})"><img src="assets/icons/add_top_icon.svg" alt="Insert Up"></div>
    <div class="tool-btn" title="Insert Down" (click)="actionManager.triggerAction({action: EditorAction.TABLE_INSERT_DOWN, params: {row, type}})"><img src="assets/icons/add_bottom_icon.svg" alt="Insert Down"></div>
    <div class="tool-btn" title="Edit Row Settings" (click)="actionManager.triggerAction({action: EditorAction.TABLE_EDIT_ROW, params: {row, type}})"><img src="assets/icons/edit_icon.svg" alt="Edit Part Settings"></div>
    <div class="tool-btn" title="Delete Row" (click)="actionManager.triggerAction({action: EditorAction.TABLE_DELETE_ROW, params: {row, type}})"><img src="assets/icons/delete_icon.svg" alt="Delete Row"></div>
  </div>
</ng-template>


